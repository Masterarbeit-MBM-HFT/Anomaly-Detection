2025-09-10 00:07:30,429 - INFO - Starting anomaly detection script
2025-09-10 00:07:30,429 - INFO - Loading data from ./anomaly_detection_final/data/input/warnings_vin_sample.csv
2025-09-10 00:07:30,473 - INFO - Converted reporting_date to datetime
2025-09-10 00:07:30,473 - INFO - Dataframe shape: (5055, 8)
2025-09-10 00:07:30,483 - INFO - Dataframe info:
None
2025-09-10 00:07:30,489 - INFO - 5 Number statistics of anomaly_flag is: count    5055.000000
mean        0.006726
std         0.081744
min         0.000000
25%         0.000000
50%         0.000000
75%         0.000000
max         1.000000
Name: anomaly_flag, dtype: float64
2025-09-10 00:07:30,491 - INFO - Constant columns: ['entity_name']
2025-09-10 00:07:30,494 - INFO - High-cardinality categoricals: ['ctt_cms_contract_number', 'ctt_vin', 'reporting_date']
2025-09-10 00:07:30,506 - INFO - Feature Information:
                                  dtype  n_missing  % missing  n_unique
layer_name                       object          0       0.00         2
ctt_cms_contract_number          object          0       0.00      4680
ctt_vin                          object       1126      22.27      3563
ctt_asset_type_segment           object          0       0.00         5
entity_name                      object          0       0.00         1
reporting_date           datetime64[ns]          0       0.00       136
anomaly_description              object          0       0.00         2
anomaly_flag                      int64          0       0.00         2
2025-09-10 00:07:30,509 - INFO - Number of duplicate rows: 59
2025-09-10 00:07:30,512 - INFO - Records with missing VIN but 'No anomaly detected': 1126
2025-09-10 00:07:30,512 - INFO - Analyzing class imbalance
2025-09-10 00:07:30,513 - INFO - Class counts: {0: 5021, 1: 34}
2025-09-10 00:07:30,513 - INFO - Class imbalance ratio: 147.6764705882353
2025-09-10 00:07:30,513 - INFO - Prevalence: 0.006726013847675569
2025-09-10 00:07:30,513 - INFO - Wilson 95% CI for prevalence: low: 0.004817300212341197, high: 0.009383868060175026
2025-09-10 00:07:30,514 - INFO - Standard Error: 0.0011496160788123943
2025-09-10 00:07:30,514 - INFO - Required sample size total: 385
2025-09-10 00:07:30,514 - INFO - Required positives: 3
2025-09-10 00:07:30,514 - INFO - Required negatives: 382
2025-09-10 00:07:30,515 - INFO - Calculating correlation with target
2025-09-10 00:07:30,516 - INFO - Correlation with target variable 'anomaly_flag':
anomaly_flag    1.0
Name: anomaly_flag, dtype: float64
2025-09-10 00:07:30,520 - INFO - Dropping columns: ['entity_name', 'anomaly_description']
2025-09-10 00:07:30,522 - INFO - Dropping highly correlated columns: []
2025-09-10 00:07:30,522 - INFO - Final dataframe shape for modeling: (5055, 6)
2025-09-10 00:07:31,290 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-09-10 00:07:31,294 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-09-10 00:07:31,313 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-09-10 00:07:31,317 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-09-10 00:07:34,064 - INFO - Numeric features: []
2025-09-10 00:07:34,064 - INFO - Categorical features: ['layer_name', 'ctt_cms_contract_number', 'ctt_vin', 'ctt_asset_type_segment']
2025-09-10 00:07:34,064 - INFO - Training Logistic Regression model
2025-09-10 00:07:34,147 - INFO - Training Random Forest model
2025-09-10 00:07:35,473 - INFO - Evaluating model performance
2025-09-10 00:07:35,553 - INFO - Evaluation metrics: {'train_accuracy': 0.9933234421364985, 'test_accuracy': 0.9930761622156281, 'roc_auc': np.float64(0.5898548662492885), 'precision': np.float64(0.0), 'recall': np.float64(0.0), 'pr_auc': np.float64(0.008683938732535238), 'f1': np.float64(0.0), 'balanced_acc': np.float64(0.5)}
2025-09-10 00:07:35,559 - INFO - Classification report:
              precision    recall  f1-score   support

           0       0.99      1.00      1.00      1004
           1       0.00      0.00      0.00         7

    accuracy                           0.99      1011
   macro avg       0.50      0.50      0.50      1011
weighted avg       0.99      0.99      0.99      1011

2025-09-10 00:07:35,560 - INFO - Confusion matrix:
[[1004    0]
 [   7    0]]
2025-09-10 00:07:35,560 - INFO - Evaluating model performance
2025-09-10 00:07:35,936 - INFO - Evaluation metrics: {'train_accuracy': 0.9980217606330366, 'test_accuracy': 0.9910979228486647, 'roc_auc': np.float64(0.49302788844621515), 'precision': np.float64(0.0), 'recall': np.float64(0.0), 'pr_auc': np.float64(0.006923837784371909), 'f1': np.float64(0.0), 'balanced_acc': np.float64(0.499003984063745)}
2025-09-10 00:07:35,939 - INFO - Classification report:
              precision    recall  f1-score   support

           0       0.99      1.00      1.00      1004
           1       0.00      0.00      0.00         7

    accuracy                           0.99      1011
   macro avg       0.50      0.50      0.50      1011
weighted avg       0.99      0.99      0.99      1011

2025-09-10 00:07:35,939 - INFO - Confusion matrix:
[[1002    2]
 [   7    0]]
